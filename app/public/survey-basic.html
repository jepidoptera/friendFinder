<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
</head>
<script>
    var questions = [
        {
            question: "How do you feel about thunderstorms?",
            answers: ["Terrified", "They're pretty cool", "I am strangely turned on by them"]
        },
        {
            question: "Do you like to travel?",
            answers: ["Yes, I want to see the world", "Sometimes, but it's not a big priority", "I barely like to leave my house"]
        },
        {
            question: "Would you ever go for a walk at night... in a cemetery?",
            answers: ["No. Too spooky.", "Maybe, with the right company.", "Yes."]
        },
        {
            question: "How messy is your car, if you have one, or would it be, if you did?",
            answers: ["Spotless", "Could be cleaner", "It's a dump"]
        },
        // {
        //     question: "Do you like to travel?",
        //     answers: ["Yes, I want to see the world", "Sometimes, but it's not a big priority", "I barely like to leave my house"]
        // },
        // {
        //     question: "Do you like to travel?",
        //     answers: ["Yes, I want to see the world", "Sometimes, but it's not a big priority", "I barely like to leave my house"]
        // },
        // {
        //     question: "Do you like to travel?",
        //     answers: ["Yes, I want to see the world", "Sometimes, but it's not a big priority", "I barely like to leave my house"]
        // },
        // {
        //     question: "Do you like to travel?",
        //     answers: ["Yes, I want to see the world", "Sometimes, but it's not a big priority", "I barely like to leave my house"]
        // },
        // {
        //     question: "Do you like to travel?",
        //     answers: ["Yes, I want to see the world", "Sometimes, but it's not a big priority", "I barely like to leave my house"]
        // },
        // {
        //     question: "Do you like to travel?",
        //     answers: ["Yes, I want to see the world", "Sometimes, but it's not a big priority", "I barely like to leave my house"]
        // },
    ]
    $(document).ready(() => {
        var currentQuestion = -1;
        var questionLabels = [];
        var answerButtons = [];
        for (i = 0; i < questions.length; i++) {
            questionLabels.push($("<p>").text(questions[i].question));
            answerButtons.push(questions[i].answers.map((answer, j) => {return $("<button>").text(answer).data('answer', j)}));
            answerButtons[i].forEach(answer => {
                answer.click(() => {
                    // post that answer to the api
                    $.post("/api/answer", {question: questions[i], answer: answer.data('answer')});
                    // get the next question
                    nextQuestion();
                })
            });
        }

        function nextQuestion() {
            currentQuestion += 1;
            if (currentQuestion >= questionLabels.length) {
                location.href = "/api/match/";
            }
            else {
                $("#questionFrame")
                .empty()
                .append(questionLabels[currentQuestion])
                .append($("<br>"))
                .append(answerButtons[currentQuestion]);
            }
        }

        nextQuestion();
    })
</script>
<body>
    <div id="questionFrame"></div>
</body>
</html>